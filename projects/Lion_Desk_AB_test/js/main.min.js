$(document).ready(function(){$("input, textarea").placeholder();$("#phone").mask("999-999-9999");$("#btnSubmit").click(function(e){validate_form()})});jQuery.validator.addMethod("noSpace",function(value,element){return value.indexOf(" ")<0&&value!=""},"No space please and don't leave it empty");jQuery.validator.addMethod("phoneUS",function(phone_number,element){phone_number=phone_number.replace(/\s+/g,"");return this.optional(element)||phone_number.length>9&&phone_number.match(/^(1-?)?(\([2-9]\d{2}\)|[2-9]\d{2})-?[2-9]\d{2}-?\d{4}$/)},"Please specify a valid phone number");jQuery.validator.addMethod("notEqual",function(value,element,param){return this.optional(element)||value!==param},"Please choose a value!");jQuery.validator.addMethod("accept",function(value,element,param){return value.match(new RegExp("^"+param+"$"))});jQuery.validator.addMethod("notEmpty",function(value,element,param){return value!=""},"This cannot be blank");function validate_form(){$("#leadwebform").validate({errorElement:"label",errorContainer:$("#warning"),invalidHandler:function(form,validator){var errors=validator.numberOfInvalids();if(errors){$("#warning").animate({height:15,opacity:1},500);$("label.error").animate({opacity:.7},100).animate({opacity:1},100).animate({opacity:.7},100).animate({opacity:1},100);$(".banner-height").css({height:"initial"})}},success:function(label){label.remove()},rules:{firstname:{required:true,accept:"[a-zA-Z ]+",notEqual:"FIRST NAME"},lastname:{required:true,accept:"[a-zA-Z ]+",notEqual:"LAST NAME"},email:{required:true,email:true},phone:{required:true,phoneUS:true}},messages:{firstname:"&#8593; Please enter your first name",lastname:"&#8593; Please enter your last name",email:"&#8593; Invalid email address",phone:"&#8593; Please enter a valid phone number"},submitHandler:function(form){do_post()}})}function do_post(){var form=$("#leadwebform");var submit=$("#btnSubmit");var alert=$("#alertmsg");var before_submit=$("#before-submit");var after_submit=$("#after-submit");var thankyou_pixel=$("#thankyou-pixel");var postData=form.serialize();$.ajax({url:"form-post.php?callback=?",type:"GET",data:postData,dataType:"jsonp",contentType:"application/json",jsonpCallback:"jsonCallback",beforeSend:function(){after_submit.fadeOut()},success:function(msg,msgtype){before_submit.fadeOut();after_submit.fadeIn();alert.html("<h2>Thank you for your interest in Top Producer<sup>&reg;</sup> CRM. A Sales Consultant will be in touch to help you shortly.</h2>");dataLayer.push({event:"gtm-lead-success"})},error:function(e){}})}